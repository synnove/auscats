DROP DATABASE auscats;
CREATE DATABASE auscats;
USE auscats;
CREATE TABLE ADMIN (USERID VARCHAR(8) NOT NULL,
    PRIMARY KEY (USERID));

CREATE TABLE COURSES (CID INT(6) UNSIGNED NOT NULL AUTO_INCREMENT, 
    STATUS VARCHAR(10) NOT NULL,
    NAME VARCHAR(50) NOT NULL, 
    BLURB VARCHAR(500) NOT NULL, 
    LAST_MODIFIED DATETIME(6),
    PRIMARY KEY(CID), 
    UNIQUE KEY course (NAME));

CREATE TABLE COURSE_CONTENT (CID INT(6) UNSIGNED NOT NULL, 
    REVISION INT(6) UNSIGNED NOT NULL, 
    CONTENT BLOB, 
    TIME_CREATED TIMESTAMP(6),
    PRIMARY KEY(CID, REVISION));

CREATE TABLE QUESTIONS (QID INT(3) UNSIGNED NOT NULL AUTO_INCREMENT, 
    QUESTION VARCHAR(200) NOT NULL, 
    PRIMARY KEY(QID));

CREATE TABLE ANSWERS (AID INT(6) UNSIGNED NOT NULL AUTO_INCREMENT, 
    ANSWER VARCHAR(200) NOT NULL,
    PRIMARY KEY(AID));

CREATE TABLE QUIZ_QUESTIONS (COURSE INT(6) UNSIGNED NOT NULL,
    QUESTION INT(6) UNSIGNED NOT NULL,
    FOREIGN KEY (COURSE) REFERENCES COURSES (CID) 
    ON UPDATE NO ACTION ON DELETE NO ACTION,
    FOREIGN KEY (QUESTION) REFERENCES QUESTIONS (QID) 
    ON UPDATE NO ACTION ON DELETE NO ACTION);

CREATE TABLE QUIZ_ANSWERS (QUESTION INT(6) UNSIGNED NOT NULL,
    ANSWER INT(6) UNSIGNED NOT NULL,
    FOREIGN KEY (QUESTION) REFERENCES QUESTIONS (QID)
    ON UPDATE NO ACTION ON DELETE NO ACTION,
    FOREIGN KEY (ANSWER) REFERENCES ANSWERS (AID)
    ON UPDATE NO ACTION ON DELETE NO ACTION);

CREATE TABLE QUIZ_CORRECT (QUESTION INT(6) UNSIGNED NOT NULL,
    ANSWER INT(6) UNSIGNED NOT NULL,
    FOREIGN KEY (QUESTION) REFERENCES QUESTIONS (QID)
    ON UPDATE NO ACTION ON DELETE NO ACTION,
    FOREIGN KEY (ANSWER) REFERENCES ANSWERS (AID)
    ON UPDATE NO ACTION ON DELETE NO ACTION);

CREATE TABLE USER_PROGRESS (USERID VARCHAR(8) NOT NULL,
    CID INT(6) UNSIGNED NOT NULL,
    LAST_VIEWED INT(2) UNSIGNED NOT NULL,
    FOREIGN KEY (CID) REFERENCES COURSES (CID)
    ON UPDATE NO ACTION ON DELETE NO ACTION);

CREATE TABLE GRADEBOOK (USERID VARCHAR (8) NOT NULL,
    ORGUNIT VARCHAR(50) NOT NULL,
    QUESTION INT(6) UNSIGNED NOT NULL,
    ANSWER INT(6) UNSIGNED NOT NULL,
    FOREIGN KEY (QUESTION) REFERENCES QUESTIONS (QID)
    ON UPDATE NO ACTION ON DELETE NO ACTION,
    FOREIGN KEY (ANSWER) REFERENCES ANSWERS (AID)
    ON UPDATE NO ACTION ON DELETE NO ACTION);
